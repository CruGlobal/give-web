<form novalidate name="$ctrl.creditCardPaymentForm" ng-keyup="$event.key === 'Enter' && $ctrl.savePayment()">

  <div class="mb">

    <h4 class="panel-title  border-bottom-small  visible" translate>Credit Card Payment</h4>

    <div class="row">
      <div class="col-sm-6">
        <div class="form-group is-required" ng-class="{'has-error': ($ctrl.creditCardPaymentForm.cardNumber | showErrors)}">
          <label translate>Card #</label>
          <input type="text" name="cardNumber" class="form-control  form-control-subtle" ng-model="$ctrl.creditCardPayment.cardNumber" ng-attr-placeholder="************{{$ctrl.creditCardPayment.cardNumberPlaceholder}}" ng-required="!$ctrl.paymentMethod || $ctrl.creditCardPayment.cardNumber">
          <div ng-messages="$ctrl.creditCardPaymentForm.cardNumber.$error" role="alert" ng-if="($ctrl.creditCardPaymentForm.cardNumber | showErrors)">
            <div class="help-block" ng-message="required" translate>You must enter a card number</div>
            <div class="help-block" ng-message="minlength" translate>This card number must contain at least 13 digits</div>
            <div class="help-block" ng-message="maxlength" translate>This card number cannot contain more than 16 digits</div>
            <div class="help-block" ng-message="cardNumber" translate>{{$ctrl.paymentValidationService.getCardNumberErrorMessage($ctrl.creditCardPaymentForm.cardNumber.$viewValue)}}</div>
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group is-required" ng-class="{'has-error': ($ctrl.creditCardPaymentForm.cardholderName | showErrors)}">
          <label translate>Name On Card</label>
          <input type="text" name="cardholderName" class="form-control  form-control-subtle" ng-model="$ctrl.creditCardPayment.cardholderName" required>
          <div role="alert" ng-messages="$ctrl.creditCardPaymentForm.cardholderName.$error" ng-if="($ctrl.creditCardPaymentForm.cardholderName | showErrors)">
            <div class="help-block" ng-message="required" translate>You must enter the name on the card</div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-4">
        <div class="form-group is-required" ng-class="{'has-error': ($ctrl.creditCardPaymentForm.expiryMonth | showErrors)}">
          <label translate>Exp. Month</label>
          <select class="form-control  form-control-subtle"
                  name="expiryMonth"
                  required
                  ng-model="$ctrl.creditCardPayment.expiryMonth">
            <option value="01" translate>01 - January</option>
            <option value="02" translate>02 - February</option>
            <option value="03" translate>03 - March</option>
            <option value="04" translate>04 - April</option>
            <option value="05" translate>05 - May</option>
            <option value="06" translate>06 - June</option>
            <option value="07" translate>07 - July</option>
            <option value="08" translate>08 - August</option>
            <option value="09" translate>09 - September</option>
            <option value="10" translate>10 - October</option>
            <option value="11" translate>11 - November</option>
            <option value="12" translate>12 - December</option>
          </select>
          <div role="alert" ng-messages="$ctrl.creditCardPaymentForm.expiryMonth.$error" ng-if="($ctrl.creditCardPaymentForm.expiryMonth | showErrors)">
            <div class="help-block" ng-message="required" translate>You must choose an expiration month</div>
            <div class="help-block" ng-message="expired" translate>Your credit card is expired or you selected the wrong month or year</div>
          </div>
        </div>
      </div>
      <div class="col-sm-4">
        <div class="form-group is-required" ng-class="{'has-error': ($ctrl.creditCardPaymentForm.expiryYear | showErrors)}">
          <label translate>Exp. Year</label>
          <select class="form-control  form-control-subtle"
                  name="expiryYear"
                  required
                  ng-model="$ctrl.creditCardPayment.expiryYear"
                  ng-options="year for year in $ctrl.expirationDateYears">
          </select>
          <div role="alert" ng-messages="$ctrl.creditCardPaymentForm.expiryYear.$error" ng-if="($ctrl.creditCardPaymentForm.expiryYear | showErrors)">
            <div class="help-block" ng-message="required" translate>You must choose an expiration year</div>
          </div>
        </div>
      </div>
      <div class="col-sm-4" ng-if="!$ctrl.paymentMethod">
        <div class="form-group is-required" ng-class="{'has-error': ($ctrl.creditCardPaymentForm.securityCode | showErrors)}">
          <label translate>CVV Code</label>
          <input type="text" name="securityCode" class="form-control form-control-subtle" ng-model="$ctrl.creditCardPayment.securityCode" ng-attr-placeholder="{{$ctrl.paymentMethod ? '****' : ''}}" required>
          <div role="alert" ng-messages="$ctrl.creditCardPaymentForm.securityCode.$error" ng-if="($ctrl.creditCardPaymentForm.securityCode | showErrors)">
            <div class="help-block" ng-message="required" translate>You must enter the security code</div>
            <div class="help-block" ng-message="minlength" translate>The security code must be at least 3 digits</div>
            <div class="help-block" ng-message="maxlength" translate>The security code cannot be more than 4 digits</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mb">

    <div class="">
      <label class="checkbox-inline">
        <input name="useMailingAddress" type="checkbox" ng-model="$ctrl.useMailingAddress"> Same as Mailing Address
      </label>
    </div>

    <div class="billing-address-new-wrap mt- on" id="address-billing-current" ng-if="$ctrl.useMailingAddress">
      <div class="panel panel-default">
        <div class="panel-body">
          <h4 class="panel-title  border-bottom-small  visible" translate>Billing Address</h4>
          <display-address address="$ctrl.mailingAddress"></display-address>
          <loading ng-if="!$ctrl.mailingAddress">
            <translate>Loading mailing address...</translate>
          </loading>
        </div>
      </div>
    </div>

    <div class="billing-address-wrap mt-" id="address-billing-new" ng-if="!$ctrl.useMailingAddress" style="display: block"><!-- TODO: fix CSS so display: block isn't needed -->
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="mb">
            <h4 class="panel-title  border-bottom-small  visible">
              <span ng-if="!$ctrl.paymentMethod" translate>New</span>
              <span translate>Billing Address</span>
            </h4>
            <address-form address="$ctrl.creditCardPayment.address" parent-form="$ctrl.creditCardPaymentForm"></address-form>
          </div>
        </div>
      </div>
    </div>

  </div> <!-- // mb -->

</form>
